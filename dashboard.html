<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warranty Tracker Dashboard</title>
    <style>
        body {
            background-color: #525252;
            padding: 20px;
        }
        .dashboard {
            display: flex;
            justify-content: space-between;
        }
        .container-left {
            flex: 1;
            padding: 20px;
            margin-right: 20px;
            background-color: #a5a5a5;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }
        .container-right {
            flex: 1.5;
            background-color: #a5a5a5;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow-y: auto;
            max-height: 600px; /* Adjust the height for scrollability */
        }
        h2 {
            text-align: center;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            margin-top: 20px;
        }
        img {
            width: 50px;
            height: auto;
        }
        /* Scrollbar Styling */
        .container-right {
            scrollbar-width: thin;
            scrollbar-color: #888 #444;
        }
        .container-right::-webkit-scrollbar {
            width: 8px;
        }
        .container-right::-webkit-scrollbar-thumb {
            background-color: #888;
            border-radius: 10px;
        }
        .container-right::-webkit-scrollbar-track {
            background-color: #444;
        }
    </style>
    <!-- Adding DOMPurify via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@2.3.6/dist/purify.min.js"></script>
</head>
<body>

<div class="dashboard">
    <div class="container-left">
        <h2>Warranty Tracker</h2>

        <form id="itemForm">
            <div class="mb-3">
                <label for="itemType" class="form-label">Item Type</label>
                <select class="form-select" id="itemType" required>
                    <option value="Router">Router</option>
                    <option value="Cable">Cable</option>
                    <option value="Switch">Switch</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="itemName" class="form-label">Item Name</label>
                <input type="text" class="form-control" id="itemName" required>
            </div>
            <div class="mb-3">
                <label for="itemId" class="form-label">Item ID</label>
                <input type="text" class="form-control" id="itemId" required>
            </div>
            <div class="mb-3">
                <label for="warrantyYears" class="form-label">Warranty Life (Years)</label>
                <input type="number" class="form-control" id="warrantyYears" required>
            </div>
            <div class="mb-3">
                <label for="warrantyDays" class="form-label">Warranty Life (Days)</label>
                <input type="number" class="form-control" id="warrantyDays" required>
            </div>
            <button type="submit" class="btn btn-primary">Add Item</button>
        </form>
    </div>

    <div class="container-right">
        <table class="table table-striped" id="warrantyTable">
            <thead>
            <tr>
                <th>Item Type</th>
                <th>Item Image</th>
                <th>Item Name</th>
                <th>Item ID</th>
                <th>Warranty Expiration Date</th>
                <th>Action</th>
            </tr>
            </thead>
            <tbody>
            <!-- Dynamic rows will be added here -->
            </tbody>
        </table>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        loadTableFromStorage();
    });

    const form = document.getElementById('itemForm');
    const table = document.getElementById('warrantyTable').getElementsByTagName('tbody')[0];

    form.addEventListener('submit', function(event) {
        event.preventDefault();

        // Gather input values and sanitize them using DOMPurify
        const itemType = DOMPurify.sanitize(document.getElementById('itemType').value);
        const itemName = DOMPurify.sanitize(document.getElementById('itemName').value);
        const itemId = DOMPurify.sanitize(document.getElementById('itemId').value);
        const warrantyYears = parseInt(DOMPurify.sanitize(document.getElementById('warrantyYears').value));
        const warrantyDays = parseInt(DOMPurify.sanitize(document.getElementById('warrantyDays').value));

        // Calculate the expiration date
        const currentDate = new Date();
        const warrantyDuration = new Date();
        warrantyDuration.setFullYear(currentDate.getFullYear() + warrantyYears);
        warrantyDuration.setDate(warrantyDuration.getDate() + warrantyDays);
        const formattedDate = warrantyDuration.toISOString().split('T')[0]; // Format date to YYYY-MM-DD

        // Create item object
        const item = {
            itemType, itemName, itemId, expirationDate: formattedDate
        };

        // Add to local storage
        saveItemToStorage(item);

        // Add to table
        addItemToTable(item);

        // Reset the form
        form.reset();
    });

    function saveItemToStorage(item) {
        let items = JSON.parse(localStorage.getItem('warrantyItems')) || [];
        items.push(item);
        localStorage.setItem('warrantyItems', JSON.stringify(items));
    }

    function loadTableFromStorage() {
        let items = JSON.parse(localStorage.getItem('warrantyItems')) || [];
        items.forEach(item => addItemToTable(item));
    }

    function addItemToTable(item) {
        const newRow = table.insertRow();

        const cell1 = newRow.insertCell(0);
        const cell2 = newRow.insertCell(1);
        const cell3 = newRow.insertCell(2);
        const cell4 = newRow.insertCell(3);
        const cell5 = newRow.insertCell(4);
        const cell6 = newRow.insertCell(5);

        // Safely add text content to cells
        cell1.textContent = item.itemType;
        
        // Safely add an image
        let imgElement = document.createElement('img');
        if (item.itemType === 'Router') {
            imgElement.src = 'router.png';
        } else if (item.itemType === 'Cable') {
            imgElement.src = 'cable.png';
        } else if (item.itemType === 'Switch') {
            imgElement.src = 'switch.png';
        }
        imgElement.alt = item.itemType;
        cell2.appendChild(imgElement);

        // Safely add text content for item details
        cell3.textContent = item.itemName;
        cell4.textContent = item.itemId;
        cell5.textContent = item.expirationDate;

        // Create delete button safely
        let deleteBtn = document.createElement('button');
        deleteBtn.className = 'btn btn-danger btn-sm';
        deleteBtn.textContent = 'Delete';
        deleteBtn.addEventListener('click', () => deleteItem(newRow, item.itemId));
        cell6.appendChild(deleteBtn);
    }

    function deleteItem(row, itemId) {
        // Remove row from table
        row.remove();

        // Remove item from local storage
        let items = JSON.parse(localStorage.getItem('warrantyItems')) || [];
        items = items.filter(item => item.itemId !== itemId);
        localStorage.setItem('warrantyItems', JSON.stringify(items));
    }
</script>

</body>
</html>



